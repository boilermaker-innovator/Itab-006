<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iTabs Story Generator - AI-Powered Educational Enhancement</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
        background: #f8f9fa;
        line-height: 1.6;
    }

    .hero {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        text-align: center;
        padding: 60px 20px 40px 20px;
    }
    
    .hero h1 {
        font-size: 2.5em;
        margin-bottom: 15px;
        font-weight: 700;
    }
    
    .hero p {
        font-size: 1.3em;
        opacity: 0.95;
        margin-bottom: 10px;
    }

    .hero-note {
        font-size: 0.9em;
        opacity: 0.85;
        font-style: italic;
    }

    .ai-badge {
        background: #4CAF50;
        color: white;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.5em;
        font-weight: bold;
        margin-left: 10px;
        vertical-align: middle;
    }

    .container {
        max-width: 1000px;
        margin: -20px auto 40px auto;
        padding: 0 20px;
    }

    .info-box {
        background: white;
        border-left: 4px solid #667eea;
        padding: 20px;
        margin-bottom: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .info-box h3 {
        color: #667eea;
        margin-bottom: 15px;
        font-size: 1.3em;
    }

    .info-box p {
        color: #333;
        line-height: 1.7;
        margin-bottom: 12px;
    }

    .info-box ul {
        margin-left: 20px;
        color: #333;
        line-height: 1.7;
    }

    .info-box li {
        margin-bottom: 8px;
    }

    .demo-note {
        margin-top: 15px;
        padding: 15px;
        background: #f0f4ff;
        border-radius: 8px;
        color: #667eea;
        font-weight: 600;
    }

    .form-section {
        background: white;
        padding: 30px;
        border-radius: 12px;
        margin-bottom: 25px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .form-section h2 {
        color: #333;
        margin-bottom: 25px;
        font-size: 1.8em;
        border-bottom: 3px solid #667eea;
        padding-bottom: 10px;
    }

    .ai-section {
        background: linear-gradient(135deg, #f0f4ff 0%, #e8eeff 100%);
        border: 2px solid #667eea;
    }

    .ai-section h2 {
        color: #667eea;
    }

    .form-group {
        margin-bottom: 25px;
    }
    
    label {
        display: block;
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
        font-size: 1.05em;
    }
    
    input[type="text"],
    input[type="password"],
    textarea,
    select {
        width: 100%;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 6px;
        font-size: 15px;
        font-family: Arial, sans-serif;
        transition: border-color 0.3s;
    }

    input:focus, textarea:focus, select:focus {
        outline: none;
        border-color: #667eea;
    }
    
    textarea {
        resize: vertical;
        font-family: inherit;
        min-height: 200px;
        line-height: 1.6;
    }

    small {
        color: #666;
        display: block;
        margin-top: 6px;
        font-size: 13px;
    }

    .api-required {
        background: #fff3cd;
        border: 2px solid #ffc107;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .api-required strong {
        color: #856404;
    }

    .button-group {
        display: flex;
        gap: 15px;
        margin-top: 25px;
    }
    
    button {
        padding: 15px 30px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        transition: all 0.3s;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    button:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }

    button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }
    
    .btn-generate {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        flex: 1;
        font-size: 18px;
    }

    .btn-generate:hover:not(:disabled) {
        background: linear-gradient(135deg, #5568d3 0%, #653a8a 100%);
    }
    
    .btn-clear {
        background: #f44336;
        color: white;
    }
    
    .btn-clear:hover {
        background: #da190b;
    }

    .loading {
        display: none;
        text-align: center;
        padding: 30px;
        background: white;
        border-radius: 12px;
        margin-bottom: 25px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .loading.active {
        display: block;
    }

    .loading-spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .loading h3 {
        color: #667eea;
        margin-bottom: 10px;
        font-size: 1.3em;
    }

    .loading p {
        color: #666;
        font-size: 1.05em;
    }

    .error-message {
        background: #f8d7da;
        border: 2px solid #f5c6cb;
        color: #721c24;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        display: none;
    }

    .error-message.active {
        display: block;
    }

    .error-message h4 {
        margin-bottom: 10px;
        font-size: 1.2em;
    }

    .results-section {
        display: none;
        background: white;
        padding: 30px;
        border-radius: 12px;
        margin-bottom: 25px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .results-section.active {
        display: block;
    }

    .results-section h2 {
        color: #333;
        margin-bottom: 20px;
        font-size: 1.8em;
    }

    .stats-box {
        background: #f0f4ff;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        border-left: 4px solid #667eea;
    }

    .stats-box h4 {
        color: #667eea;
        margin-bottom: 10px;
        font-size: 1.2em;
    }

    .stats-box ul {
        list-style: none;
        padding: 0;
    }

    .stats-box li {
        padding: 5px 0;
        color: #4a5568;
    }

    .preview-box {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 8px;
        margin-bottom: 20px;
        border: 2px solid #e0e0e0;
    }

    .preview-box h3 {
        color: #667eea;
        margin-bottom: 15px;
        font-size: 1.3em;
    }

    .enhanced-content {
        background: white;
        padding: 20px;
        border-radius: 8px;
        line-height: 1.8;
        font-size: 1.05em;
        max-height: 500px;
        overflow-y: auto;
        white-space: pre-wrap;
    }
    
    .enhanced-content p {
        margin-bottom: 15px;
    }
    
    .enhanced-content h1, .enhanced-content h2, .enhanced-content h3 {
        color: #333;
        margin-top: 25px;
        margin-bottom: 15px;
    }
    
    .enhanced-content h1 {
        font-size: 2em;
        border-bottom: 3px solid #667eea;
        padding-bottom: 10px;
    }
    
    .enhanced-content h2 {
        font-size: 1.6em;
        color: #667eea;
    }
    
    .enhanced-content h3 {
        font-size: 1.3em;
        color: #555;
    }

    .code-section {
        margin-top: 30px;
    }

    .code-section h3 {
        color: #333;
        margin-bottom: 10px;
        font-size: 1.5em;
    }
    
    .code-box {
        background: #2d3748;
        color: #e2e8f0;
        border-radius: 8px;
        padding: 20px;
        font-family: 'Courier New', monospace;
        font-size: 13px;
        max-height: 400px;
        overflow-y: auto;
        margin-bottom: 15px;
        word-wrap: break-word;
        white-space: pre-wrap;
        line-height: 1.5;
    }

    .btn-copy {
        background: #2196F3;
        color: white;
        width: 100%;
    }
    
    .btn-copy:hover {
        background: #0b7dda;
    }

    .success-message {
        display: none;
        background: #4CAF50;
        color: white;
        padding: 12px;
        border-radius: 6px;
        margin-top: 15px;
        text-align: center;
        font-weight: 600;
    }
    
    .success-message.active {
        display: block;
    }

    /* iTabs styles for preview */
    .itab-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 18px;
        height: 18px;
        background: transparent;
        color: #667eea;
        border-radius: 50%;
        font-size: 12px;
        font-weight: bold;
        cursor: pointer;
        margin: 0 2px;
        border: 2px solid #667eea;
        vertical-align: middle;
        font-family: serif;
        transition: all 0.3s;
        opacity: 0.7;
    }
    
    .itab-btn:hover {
        background: #667eea;
        color: white;
        transform: scale(1.2);
        opacity: 1;
        box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }
    
    .itab-popup {
        display: none;
        position: fixed;
        z-index: 10000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.85);
        align-items: center;
        justify-content: center;
        padding: 20px;
    }
    
    .itab-popup.active {
        display: flex;
    }
    
    .itab-popup-content {
        background: white;
        border-radius: 15px;
        max-width: 650px;
        width: 90%;
        position: relative;
        box-shadow: 0 10px 40px rgba(0,0,0,0.4);
        max-height: 85vh;
        display: flex;
        flex-direction: column;
    }

    .itab-popup-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px 30px;
        border-radius: 15px 15px 0 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .itab-popup-header h3 {
        margin: 0;
        font-size: 1.4em;
    }
    
    .itab-close {
        color: white;
        font-size: 30px;
        font-weight: bold;
        cursor: pointer;
        background: none;
        border: none;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.3s;
    }
    
    .itab-close:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: rotate(90deg);
    }

    .itab-tabs {
        display: flex;
        background: #f8f9fa;
        border-bottom: 2px solid #e0e0e0;
    }

    .itab-tab {
        flex: 1;
        padding: 15px 10px;
        text-align: center;
        cursor: pointer;
        background: none;
        border: none;
        font-size: 14px;
        font-weight: 600;
        color: #666;
        transition: all 0.3s;
        border-bottom: 3px solid transparent;
    }

    .itab-tab:hover {
        background: #f0f4ff;
        color: #667eea;
    }

    .itab-tab.active {
        color: #667eea;
        border-bottom-color: #667eea;
        background: white;
    }

    .itab-body {
        padding: 25px 30px;
        overflow-y: auto;
        flex: 1;
    }

    .itab-tab-content {
        display: none;
    }

    .itab-tab-content.active {
        display: block;
    }

    .itab-tab-content h4 {
        color: #667eea;
        margin-bottom: 12px;
        font-size: 1.2em;
    }

    .itab-tab-content p {
        color: #4a5568;
        line-height: 1.7;
        font-size: 1.05em;
        margin-bottom: 12px;
    }

    .itab-tab-content ul {
        margin-left: 20px;
        color: #4a5568;
        line-height: 1.7;
    }

    .itab-tab-content li {
        margin-bottom: 8px;
    }

    .highlight-box {
        background: #f0f4ff;
        padding: 15px;
        border-radius: 8px;
        margin-top: 12px;
        border-left: 4px solid #667eea;
    }

    @media (max-width: 600px) {
        .hero h1 {
            font-size: 1.8em;
        }
        
        .itab-tab {
            font-size: 12px;
            padding: 12px 5px;
        }
    }
</style>
```

</head>
<body>
    <div class="hero">
        <h1>iTabs Story Generator<span class="ai-badge">AI-POWERED</span></h1>
        <p>Transform any content into an educational experience</p>
        <p class="hero-note">Uses AI to identify complex terms and create 2-4 tab explanations automatically</p>
    </div>

```
<div class="container">
    <div class="info-box">
        <h3>ü§ñ How This AI Generator Works</h3>
        <p>This tool uses AI (Claude) to automatically enhance your content with educational iTabs:</p>
        <ul>
            <li><strong>Step 1:</strong> Paste your article or story below</li>
            <li><strong>Step 2:</strong> AI analyzes and identifies complex terms that need explanation</li>
            <li><strong>Step 3:</strong> AI generates smart multi-tab explanations (2-4 tabs based on complexity)</li>
            <li><strong>Step 4:</strong> Get complete HTML with working iTabs ready to use</li>
        </ul>
        <div class="demo-note">üí° The AI decides how many tabs each term needs - simple terms get 2 tabs, complex concepts get 3-4 tabs</div>
    </div>

    <div class="form-section ai-section">
        <h2>‚ú® Generate Educational iTabs</h2>
        
        <div class="api-required">
            <strong>‚ö†Ô∏è Note:</strong> This is a prototype that demonstrates the concept. In production, this would connect to AI APIs (like Claude or GPT-4) to automatically generate explanations. For now, it creates a template showing how the system would work.
        </div>

        <div class="form-group">
            <label for="storyInput">üìù Your Article/Content:</label>
            <textarea id="storyInput" placeholder="Paste your article here... The AI will identify complex terms and create educational iTabs with 2-4 tabs depending on how much explanation is needed.
```

For example:

- Simple terms = 2 tabs (What it is + Example)
- Medium complexity = 3 tabs (What it is + How it works + Why it matters)
- Complex concepts = 4 tabs (Full breakdown with deep context)‚Äù>Blockchain technology is revolutionizing how we think about digital transactions and data security. At its core, a blockchain is a distributed ledger that records transactions across multiple computers in a way that makes it nearly impossible to alter retroactively.

Each block in the chain contains a cryptographic hash of the previous block, a timestamp, and transaction data. This creates an immutable record that can be verified by network participants through a consensus mechanism like Proof of Work or Proof of Stake.

Smart contracts built on blockchain platforms like Ethereum enable self-executing agreements without intermediaries. These decentralized applications (dApps) are transforming industries from finance (DeFi) to supply chain management.

However, blockchain faces challenges including scalability issues, high energy consumption in mining operations, and regulatory uncertainty. Solutions like Layer 2 protocols and sharding are being developed to address these limitations while maintaining the security and decentralization that make blockchain valuable.</textarea>
<small>üí° <span style="color: #28a745; font-weight: 600;">Sample text included - click Generate to see AI-powered iTabs creation!</span></small>
</div>

```
        <div class="form-group">
            <label for="topicType">üìö Content Type:</label>
            <select id="topicType">
                <option value="technology">Technology/Computer Science</option>
                <option value="medical">Medical/Healthcare</option>
                <option value="science">Science/Research</option>
                <option value="business">Business/Finance</option>
                <option value="education">General Education</option>
            </select>
            <small>Helps AI provide context-appropriate explanations</small>
        </div>

        <div class="form-group">
            <label for="audienceLevel">üë• Target Audience:</label>
            <select id="audienceLevel">
                <option value="general">General Public</option>
                <option value="highschool" selected>High School Students</option>
                <option value="college">College Students</option>
                <option value="expert">Professionals/Experts</option>
            </select>
            <small>AI adjusts explanation depth based on audience</small>
        </div>

        <div class="button-group">
            <button class="btn-generate" onclick="generateStory()">üöÄ Generate iTabs Story</button>
            <button class="btn-clear" onclick="clearForm()">üîÑ Clear</button>
        </div>
    </div>

    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <h3>AI is Working...</h3>
        <p id="loadingText">Analyzing your content and generating smart explanations</p>
    </div>

    <div class="error-message" id="errorMessage">
        <h4>‚ö†Ô∏è Error</h4>
        <p id="errorText"></p>
    </div>

    <div class="results-section" id="resultsSection">
        <h2>‚ú® Your Educational iTabs Story</h2>
        
        <div class="stats-box">
            <h4>üìä Generation Summary:</h4>
            <ul id="statsList"></ul>
        </div>

        <div class="preview-box">
            <h3>üëÄ Interactive Preview (click the blue "i" buttons):</h3>
            <div class="enhanced-content" id="previewContent"></div>
        </div>

        <div class="code-section">
            <h3>üìã Complete HTML Code</h3>
            <p style="color: #666; margin-bottom: 15px;">Copy this code to use your iTabs-enhanced story anywhere:</p>
            <div class="code-box" id="codeBox"></div>
            <button class="btn-copy" onclick="copyCode()">üìã Copy Complete HTML</button>
            <div class="success-message" id="successMessage">‚úÖ Code copied to clipboard!</div>
        </div>
    </div>
</div>

<script>
    // Simulated AI-powered term identification and explanation generation
    // In production, this would call Claude API or GPT-4 API
    
    const termKnowledge = {
        'technology': {
            'blockchain': {
                term: 'Blockchain',
                complexity: 3,
                tabs: [
                    {
                        title: 'What It Is',
                        content: '<h4>Digital Ledger System</h4><p>Blockchain is like a digital record book that\'s shared across thousands of computers. Instead of one company controlling the records, everyone has a copy, making it extremely difficult to cheat or change past entries.</p><p>Think of it as a chain of blocks where each block contains transaction information, and once added, it can\'t be altered without everyone knowing.</p>'
                    },
                    {
                        title: 'How It Works',
                        content: '<h4>The Chain Mechanism</h4><p>When someone makes a transaction:</p><ul><li>The transaction is broadcast to the network</li><li>Network computers verify it\'s legitimate</li><li>Verified transactions are grouped into a "block"</li><li>The block is added to the chain with a unique code</li><li>Everyone\'s copy updates simultaneously</li></ul><p>Each block is mathematically linked to the previous one, creating an unbreakable chain of history.</p>'
                    },
                    {
                        title: 'Why It Matters',
                        content: '<h4>Revolutionary Trust System</h4><p>Blockchain solves a fundamental problem: How do you trust digital records without a central authority?</p><ul><li><strong>Banking:</strong> Transfer money without banks as middlemen</li><li><strong>Supply chains:</strong> Track products from factory to store</li><li><strong>Contracts:</strong> Automatically execute agreements when conditions are met</li><li><strong>Voting:</strong> Create tamper-proof election systems</li></ul><div class="highlight-box">It\'s called "trustless" technology - you don\'t need to trust any single entity because math and transparency create trust.</div>'
                    }
                ]
            },
            'distributed ledger': {
                term: 'Distributed Ledger',
                complexity: 2,
                tabs: [
                    {
                        title: 'Simple Explanation',
                        content: '<h4>Shared Digital Record Book</h4><p>A distributed ledger is a database that\'s shared and synchronized across multiple sites, institutions, or locations. Instead of one central database, everyone has a copy.</p><p>It\'s like if everyone in a classroom had identical notebooks that automatically update whenever anyone writes something - no single person controls "the official version."</p>'
                    },
                    {
                        title: 'Benefits',
                        content: '<h4>Why Distribution Matters</h4><ul><li><strong>No single point of failure:</strong> If one copy is destroyed, thousands remain</li><li><strong>Transparency:</strong> Everyone can see all transactions</li><li><strong>Security:</strong> Hackers can\'t change one copy without controlling the majority</li><li><strong>Redundancy:</strong> Data is backed up across the network automatically</li></ul><p>This is what makes systems like Bitcoin possible - no bank or government needs to maintain the records.</p>'
                    }
                ]
            },
            'cryptographic hash': {
                term: 'Cryptographic Hash',
                complexity: 3,
                tabs: [
                    {
                        title: 'What It Is',
                        content: '<h4>Digital Fingerprint</h4><p>A cryptographic hash is like a unique fingerprint for digital data. It takes any amount of data (a document, transaction, or entire file) and converts it into a fixed-length string of characters.</p><p>For example, the phrase "Hello World" might become "2ef7bde608ce5404e97d5f042f95f89f1c232871"</p><p>Even the tiniest change in the original data creates a completely different hash.</p>'
                    },
                    {
                        title: 'How It Works',
                        content: '<h4>One-Way Transformation</h4><p>Hash functions are "one-way" - easy to create, impossible to reverse:</p><ul><li>Input any data ‚Üí Output a unique hash</li><li>Same input = Always same hash</li><li>Different input = Completely different hash</li><li>Cannot reverse the hash to get original data</li></ul><p>Change even one letter and the entire hash becomes unrecognizable, making tampering immediately obvious.</p>'
                    },
                    {
                        title: 'Blockchain Use',
                        content: '<h4>Security Through Hashing</h4><p>In blockchain, each block contains the hash of the previous block, creating the "chain:"</p><ul><li>Block 1 has its own hash</li><li>Block 2 contains Block 1\'s hash plus its data</li><li>Block 3 contains Block 2\'s hash plus its data</li></ul><div class="highlight-box">If someone tries to change Block 1, its hash changes, breaking the link to Block 2, and cascading through the entire chain - making tampering immediately obvious to everyone.</div>'
                    }
                ]
            },
            'consensus mechanism': {
                term: 'Consensus Mechanism',
                complexity: 3,
                tabs: [
                    {
                        title: 'What It Is',
                        content: '<h4>Agreement System</h4><p>A consensus mechanism is how blockchain networks agree on which transactions are valid when there\'s no central authority making decisions.</p><p>It\'s like a classroom voting system where students collectively decide what\'s correct rather than just believing the teacher.</p>'
                    },
                    {
                        title: 'How It Works',
                        content: '<h4>Reaching Agreement</h4><p>Different blockchain networks use different methods:</p><ul><li><strong>Voting:</strong> Network participants vote on transaction validity</li><li><strong>Competition:</strong> Computers race to solve puzzles (mining)</li><li><strong>Stake:</strong> People with more invested get more voting power</li></ul><p>The key is that no single entity can control the outcome - the network collectively decides what\'s true.</p>'
                    },
                    {
                        title: 'Types',
                        content: '<h4>Popular Mechanisms</h4><p><strong>Proof of Work (PoW):</strong> Solve complex math problems to add blocks (Bitcoin uses this)<br><strong>Proof of Stake (PoS):</strong> Validators chosen based on how much cryptocurrency they hold and "stake"<br><strong>Proof of Authority (PoA):</strong> Pre-approved validators verify transactions</p><div class="highlight-box">Each has tradeoffs: PoW is secure but energy-intensive, PoS is efficient but potentially centralizing, PoA is fast but less decentralized.</div>'
                    }
                ]
            },
            'smart contracts': {
                term: 'Smart Contracts',
                complexity: 3,
                tabs: [
                    {
                        title: 'What They Are',
                        content: '<h4>Self-Executing Agreements</h4><p>Smart contracts are computer programs that automatically execute when specific conditions are met - like a digital vending machine that releases your snack when you insert correct payment.</p><p>Unlike traditional contracts that require lawyers and courts to enforce, smart contracts enforce themselves through code.</p>'
                    },
                    {
                        title: 'How They Work',
                        content: '<h4>Automatic Execution</h4><p>Smart contracts follow "if-then" logic stored on the blockchain:</p><ul><li><strong>If</strong> condition A happens ‚Üí <strong>Then</strong> execute action B</li><li>Example: <strong>If</strong> Bob pays 1 ETH ‚Üí <strong>Then</strong> transfer digital art to Bob</li><li>Once triggered, no one can stop or reverse it</li><li>Everyone can see the code and verify it works as promised</li></ul><p>The blockchain ensures the contract executes exactly as written, with no human intervention needed.</p>'
                    },
                    {
                        title: 'Real Uses',
                        content: '<h4>Practical Applications</h4><ul><li><strong>DeFi (Finance):</strong> Automated lending, borrowing, trading without banks</li><li><strong>Insurance:</strong> Automatic payouts when flight delayed, crop fails, etc.</li><li><strong>Real estate:</strong> Transfer property ownership when payment received</li><li><strong>Supply chain:</strong> Release payment when delivery confirmed</li><li><strong>Gaming:</strong> Enforce game rules and trade digital items</li></ul><div class="highlight-box">Smart contracts eliminate middlemen, reduce costs, and ensure agreements execute exactly as intended - but bugs in code can cause permanent losses since contracts can\'t be stopped once running.</div>'
                    }
                ]
            },
            'ethereum': {
                term: 'Ethereum',
                complexity: 2,
                tabs: [
                    {
                        title: 'What It Is',
                        content: '<h4>Programmable Blockchain</h4><p>Ethereum is a blockchain platform that goes beyond just cryptocurrency. While Bitcoin is like digital gold, Ethereum is like a global computer that anyone can use to build applications.</p><p>It has its own cryptocurrency (Ether/ETH) used to pay for computing power on the network.</p>'
                    },
                    {
                        title: 'Why It\'s Different',
                        content: '<h4>Beyond Digital Money</h4><p>Ethereum\'s key innovation is enabling smart contracts and decentralized apps:</p><ul><li><strong>Bitcoin:</strong> Digital currency only</li><li><strong>Ethereum:</strong> Platform for building entire applications</li><li>Developers write programs that run on Ethereum\'s blockchain</li><li>These apps can\'t be shut down or censored</li><li>Powers NFTs, DeFi, games, and more</li></ul><div class="highlight-box">Think of Bitcoin as a calculator and Ethereum as a smartphone - both useful, but one can do far more.</div>'
                    }
                ]
            },
            'decentralized applications': {
                term: 'Decentralized Applications (dApps)',
                complexity: 3,
                tabs: [
                    {
                        title: 'What They Are',
                        content: '<h4>Apps Without Companies</h4><p>Decentralized applications (dApps) are like regular apps (Instagram, Uber, Airbnb) but they run on blockchain networks instead of company servers.</p><p>No single company owns or controls them - they\'re collectively operated by users on the network.</p>'
                    },
                    {
                        title: 'Key Differences',
                        content: '<h4>Traditional vs Decentralized</h4><p><strong>Traditional App (Facebook):</strong></p><ul><li>Facebook owns all your data</li><li>Facebook can ban your account</li><li>Facebook decides what features to add</li><li>Facebook profits from your content</li></ul><p><strong>Decentralized App:</strong></p><ul><li>You own your data</li><li>No one can ban you (censorship-resistant)</li><li>Community votes on changes</li><li>Users can share in profits through tokens</li></ul>'
                    },
                    {
                        title: 'Real Examples',
                        content: '<h4>dApps You Can Use Today</h4><ul><li><strong>Uniswap:</strong> Trade cryptocurrencies without a company</li><li><strong>OpenSea:</strong> Buy/sell NFTs peer-to-peer</li><li><strong>Aave:</strong> Lend and borrow money automatically</li><li><strong>Decentraland:</strong> Virtual world owned by users</li></ul><div class="highlight-box">The tradeoff: dApps are harder to use and slower than traditional apps, but offer user control and transparency that centralized platforms can\'t match.</div>'
                    }
                ]
            },
            'defi': {
                term: 'DeFi (Decentralized Finance)',
                complexity: 3,
                tabs: [
                    {
                        title: 'What It Is',
                        content: '<h4>Banking Without Banks</h4><p>DeFi recreates traditional financial services (lending, borrowing, trading, insurance) using smart contracts instead of banks and financial institutions.</p><p>Anyone with internet access can use DeFi services without permission, credit checks, or paperwork.</p>'
                    },
                    {
                        title: 'How It Works',
                        content: '<h4>Automated Finance</h4><p>DeFi platforms use smart contracts to provide services automatically:</p><ul><li><strong>Lending:</strong> Deposit crypto, earn interest paid by borrowers</li><li><strong>Borrowing:</strong> Lock up collateral, automatically receive a loan</li><li><strong>Trading:</strong> Swap currencies instantly through liquidity pools</li><li><strong>Insurance:</strong> Buy protection that pays out automatically</li></ul><p>No loan officers, no waiting, no discrimination - just code executing based on the rules.</p>'
                    },
                    {
                        title: 'Risks & Benefits',
                        content: '<h4>The Reality</h4><p><strong>Benefits:</strong></p><ul><li>24/7 access from anywhere</li><li>Often better interest rates than banks</li><li>Full transparency (see all code and transactions)</li><li>No one can freeze your funds</li></ul><p><strong>Risks:</strong></p><ul><li>Smart contract bugs can lose all funds</li><li>No customer service if something goes wrong</li><li>Complex to use correctly</li><li>Regulatory uncertainty</li></ul><div class="highlight-box">DeFi is powerful but unforgiving - mistakes can\'t be reversed, so understanding how it works is critical before using it.</div>'
                    }
                ]
            },
            'scalability': {
                term: 'Scalability',
                complexity: 2,
                tabs: [
                    {
                        title: 'The Problem',
                        content: '<h4>Growing Pains</h4><p>Scalability is a system\'s ability to handle increasing amounts of work. In blockchain, it\'s a major challenge: as more people use the network, transaction speed slows down and costs increase.</p><p>Bitcoin processes 7 transactions per second. Visa processes 24,000 per second. This gap is blockchain\'s biggest practical limitation.</p>'
                    },
                    {
                        title: 'Why It\'s Hard',
                        content: '<h4>The Blockchain Trilemma</h4><p>Blockchain faces three competing goals - achieving all three simultaneously is extremely difficult:</p><ul><li><strong>Decentralization:</strong> Many people control the network</li><li><strong>Security:</strong> System is safe from attacks</li><li><strong>Scalability:</strong> Can handle many transactions quickly</li></ul><p>Most blockchains can only optimize for two: Bitcoin prioritizes decentralization + security but sacrifices speed.</p><div class="highlight-box">This is why blockchain solutions are still searching for the "perfect" approach that achieves all three.</div>'
                    }
                ]
            },
            'mining': {
                term: 'Mining',
                complexity: 3,
                tabs: [
                    {
                        title: 'What It Is',
                        content: '<h4>Creating New Blocks</h4><p>Mining is the process of using computers to solve complex mathematical puzzles in order to add new blocks to the blockchain. Successful miners receive cryptocurrency as a reward.</p><p>It\'s called "mining" because, like mining for gold, it requires work (computing power) to discover something valuable (new bitcoins).</p>'
                    },
                    {
                        title: 'How It Works',
                        content: '<h4>The Race</h4><p>Thousands of mining computers compete simultaneously:</p><ul><li>Network broadcasts pending transactions</li><li>Miners gather them into a potential block</li><li>They race to solve a cryptographic puzzle</li><li>First to solve it adds their block to the chain</li><li>Winner receives cryptocurrency reward + transaction fees</li><li>Everyone else starts working on the next block</li></ul><p>The difficulty adjusts so a new block is found approximately every 10 minutes for Bitcoin.</p>'
                    },
                    {
                        title: 'Energy Issue',
                        content: '<h4>The Environmental Cost</h4><p>Bitcoin mining consumes massive amounts of electricity:</p><ul><li>Uses more power annually than some countries</li><li>Specialized mining computers run 24/7</li><li>Huge data centers filled with mining equipment</li><li>Carbon footprint roughly equal to New Zealand</li></ul><div class="highlight-box">This is why many newer blockchains use Proof of Stake instead of mining - same security without the energy consumption.</div>'
                    }
                ]
            },
            'layer 2': {
                term: 'Layer 2 Protocols',
                complexity: 3,
                tabs: [
                    {
                        title: 'What They Are',
                        content: '<h4>Speed Boosters</h4><p>Layer 2 protocols are systems built on top of existing blockchains (Layer 1) to make them faster and cheaper. Think of them as express lanes on a highway.</p><p>They handle transactions off the main blockchain, then submit a summary back to the main chain periodically.</p>'
                    },
                    {
                        title: 'How They Help',
                        content: '<h4>Scaling Without Compromise</h4><p>Layer 2 solutions process transactions separately then bundle results:</p><ul><li>Handle hundreds of transactions off-chain</li><li>Process them quickly and cheaply</li><li>Submit one combined transaction to main blockchain</li><li>Main chain only stores the summary</li></ul><p>This way the main blockchain stays secure and decentralized while Layer 2 provides speed.</p>'
                    },
                    {
                        title: 'Real Solutions',
                        content: '<h4>Popular Examples</h4><p><strong>Lightning Network (Bitcoin):</strong> Instant Bitcoin payments for pennies<br><strong>Polygon (Ethereum):</strong> Fast, cheap Ethereum transactions<br><strong>Arbitrum/Optimism:</strong> Ethereum scaling with lower fees</p><div class="highlight-box">Layer 2 solutions inherit the security of the main blockchain while dramatically improving speed and cost - it\'s how blockchain will likely achieve mainstream adoption.</div>'
                    }
                ]
            },
            'sharding': {
                term: 'Sharding',
                complexity: 2,
                tabs: [
                    {
                        title: 'What It Is',
                        content: '<h4>Divide and Conquer</h4><p>Sharding splits a blockchain into smaller pieces (shards) that can process transactions in parallel. Instead of every computer processing every transaction, different groups handle different shards.</p><p>It\'s like having multiple checkout lanes at a store instead of one - total throughput increases.</p>'
                    },
                    {
                        title: 'How It Helps',
                        content: '<h4>Parallel Processing</h4><p>Sharding dramatically increases transaction capacity:</p><ul><li>Blockchain splits into 64 shards (for example)</li><li>Each shard processes its own transactions</li><li>64 shards = 64x more transactions per second</li><li>Main chain coordinates between shards</li></ul><div class="highlight-box">Ethereum 2.0 is implementing sharding to increase from ~15 to thousands of transactions per second while maintaining security.</div>'
                    }
                ]
            }
        }
    };

    function generateStory() {
        const story = document.getElementById('storyInput').value.trim();
        const topicType = document.getElementById('topicType').value;
        const audienceLevel = document.getElementById('audienceLevel').value;
        
        if (!story) {
            showError('Please enter some content to enhance with iTabs');
            return;
        }
        
        // Show loading
        const loading = document.getElementById('loading');
        const btn = document.querySelector('.btn-generate');
        loading.classList.add('active');
        btn.disabled = true;
        
        // Simulate AI processing time
        setTimeout(() => {
            try {
                // Find terms in the text
                const foundTerms = identifyTerms(story, topicType);
                
                if (foundTerms.length === 0) {
                    showError('No technical terms found that need explanation. Try content with more specialized vocabulary.');
                    loading.classList.remove('active');
                    btn.disabled = false;
                    return;
                }
                
                // Generate enhanced version
                generateEnhancedContent(story, foundTerms, audienceLevel);
                
                // Show results
                loading.classList.remove('active');
                btn.disabled = false;
                document.getElementById('resultsSection').classList.add('active');
                
                // Scroll to results
                setTimeout(() => {
                    document.getElementById('resultsSection').scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 100);
                
            } catch (error) {
                console.error('Generation error:', error);
                showError('Something went wrong generating iTabs. Please try again.');
                loading.classList.remove('active');
                btn.disabled = false;
            }
        }, 2000);
    }

    function identifyTerms(text, topicType) {
        const textLower = text.toLowerCase();
        const foundTerms = [];
        const knowledge = termKnowledge[topicType] || termKnowledge['technology'];
        
        // Find terms in text
        for (let key in knowledge) {
            if (textLower.includes(key.toLowerCase())) {
                foundTerms.push({
                    searchTerm: key,
                    data: knowledge[key]
                });
            }
        }
        
        // Sort by complexity (most complex first to avoid partial matches)
        foundTerms.sort((a, b) => b.searchTerm.length - a.searchTerm.length);
        
        return foundTerms;
    }

    function generateEnhancedContent(text, terms, audienceLevel) {
        let enhanced = text;
        let popupHTML = '';
        const processedTerms = new Set();
        
        let totalTabs = 0;
        let tabCounts = {2: 0, 3: 0, 4: 0};
        
        terms.forEach((termObj, i) => {
            const id = 'term_' + i;
            const searchTerm = termObj.searchTerm;
            const termData = termObj.data;
            
            if (processedTerms.has(searchTerm.toLowerCase())) {
                return;
            }
            
            // Create regex for whole word/phrase
            const escapedTerm = searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const regex = new RegExp('\\b(' + escapedTerm + ')\\b', 'i');
            
            const match = enhanced.match(regex);
            if (match) {
                const matchedText = match[1];
                enhanced = enhanced.replace(
                    regex,
                    matchedText + ' <button class="itab-btn" onclick="showTerm(\'' + id + '\')">i</button>'
                );
                
                // Generate multi-tab popup
                popupHTML += generateMultiTabPopup(id, termData);
                
                totalTabs += termData.tabs.length;
                tabCounts[termData.tabs.length] = (tabCounts[termData.tabs.length] || 0) + 1;
                processedTerms.add(searchTerm.toLowerCase());
            }
        });
        
        // Format the enhanced text with proper HTML structure
        enhanced = formatTextToHTML(enhanced);
        
        // Update stats
        const tabBreakdown = Object.entries(tabCounts)
            .filter(([_, count]) => count > 0)
            .map(([tabs, count]) => `${count} terms with ${tabs} tabs`)
            .join(', ');
        
        document.getElementById('statsList').innerHTML = `
            <li><strong>${terms.length}</strong> iTabs buttons created</li>
            <li><strong>${totalTabs}</strong> total information tabs generated</li>
            <li><strong>Smart tab allocation:</strong> ${tabBreakdown}</li>
            <li><strong>${text.split(/\s+/).length}</strong> words in original content</li>
        `;
        
        // Update preview
        document.getElementById('previewContent').innerHTML = enhanced + popupHTML;
        
        // Generate full HTML
        const fullHTML = generateFullHTML(enhanced, popupHTML);
        document.getElementById('codeBox').textContent = fullHTML;
    }
    
    function formatTextToHTML(text) {
        // Split into paragraphs on double line breaks
        const paragraphs = text.split(/\n\n+/);
        
        let formatted = '';
        paragraphs.forEach(para => {
            para = para.trim();
            if (!para) return;
            
            // Check if it looks like a heading (short line, possibly ending with colon)
            if (para.length < 60 && !para.includes('.') && para.split(' ').length < 8) {
                formatted += `<h2>${para}</h2>\n`;
            } else {
                // Regular paragraph
                formatted += `<p>${para}</p>\n`;
            }
        });
        
        return formatted;
    }

    function generateMultiTabPopup(id, termData) {
        let tabsHTML = '';
        let contentHTML = '';
        
        termData.tabs.forEach((tab, index) => {
            const activeClass = index === 0 ? 'active' : '';
            tabsHTML += `
                <button class="itab-tab ${activeClass}" onclick="switchTab('${id}', ${index})">
                    ${tab.title}
                </button>
            `;
            
            contentHTML += `
                <div class="itab-tab-content ${activeClass}" id="${id}_tab${index}">
                    ${tab.content}
                </div>
            `;
        });
        
        return `
            <div class="itab-popup" id="${id}">
                <div class="itab-popup-content">
                    <div class="itab-popup-header">
                        <h3>${termData.term}</h3>
                        <button class="itab-close" onclick="closeTerm('${id}')">&times;</button>
                    </div>
                    <div class="itab-tabs">
                        ${tabsHTML}
                    </div>
                    <div class="itab-body">
                        ${contentHTML}
                    </div>
                </div>
            </div>
        `;
    }

    function generateFullHTML(enhancedText, popupHTML) {
        return `<!DOCTYPE html>
```

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iTabs Enhanced Educational Content</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; line-height: 1.8; max-width: 900px; margin: 40px auto; padding: 20px; color: #333; background: #f8f9fa; }
        .content-wrapper { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        h1 { font-size: 2.2em; color: #333; margin-bottom: 10px; border-bottom: 3px solid #667eea; padding-bottom: 15px; }
        h2 { font-size: 1.6em; color: #667eea; margin-top: 35px; margin-bottom: 15px; }
        h3 { font-size: 1.3em; color: #555; margin-top: 25px; margin-bottom: 12px; }
        p { margin-bottom: 18px; line-height: 1.8; color: #4a5568; }
        .itab-btn { display: inline-flex; align-items: center; justify-content: center; width: 18px; height: 18px; background: transparent; color: #667eea; border-radius: 50%; font-size: 12px; font-weight: bold; cursor: pointer; margin: 0 2px; border: 2px solid #667eea; vertical-align: middle; font-family: serif; transition: all 0.3s; opacity: 0.7; }
        .itab-btn:hover { background: #667eea; color: white; transform: scale(1.2); opacity: 1; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3); }
        .itab-popup { display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.85); align-items: center; justify-content: center; padding: 20px; }
        .itab-popup.active { display: flex; }
        .itab-popup-content { background: white; border-radius: 15px; max-width: 650px; width: 90%; position: relative; box-shadow: 0 10px 40px rgba(0,0,0,0.4); max-height: 85vh; display: flex; flex-direction: column; }
        .itab-popup-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 30px; border-radius: 15px 15px 0 0; display: flex; justify-content: space-between; align-items: center; }
        .itab-popup-header h3 { margin: 0; font-size: 1.4em; }
        .itab-close { color: white; font-size: 30px; font-weight: bold; cursor: pointer; background: none; border: none; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s; }
        .itab-close:hover { background: rgba(255,255,255,0.2); transform: rotate(90deg); }
        .itab-tabs { display: flex; background: #f8f9fa; border-bottom: 2px solid #e0e0e0; }
        .itab-tab { flex: 1; padding: 15px 10px; text-align: center; cursor: pointer; background: none; border: none; font-size: 14px; font-weight: 600; color: #666; transition: all 0.3s; border-bottom: 3px solid transparent; }
        .itab-tab:hover { background: #f0f4ff; color: #667eea; }
        .itab-tab.active { color: #667eea; border-bottom-color: #667eea; background: white; }
        .itab-body { padding: 25px 30px; overflow-y: auto; flex: 1; }
        .itab-tab-content { display: none; }
        .itab-tab-content.active { display: block; }
        .itab-tab-content h4 { color: #667eea; margin-bottom: 12px; font-size: 1.2em; }
        .itab-tab-content p { color: #4a5568; line-height: 1.7; font-size: 1.05em; margin-bottom: 12px; }
        .itab-tab-content ul { margin-left: 20px; color: #4a5568; line-height: 1.7; }
        .itab-tab-content li { margin-bottom: 8px; }
        .highlight-box { background: #f0f4ff; padding: 15px; border-radius: 8px; margin-top: 12px; border-left: 4px solid #667eea; }
    </style>
</head>
<body>
    <div class="content-wrapper">
        ${enhancedText}
    </div>
    ${popupHTML}

```
<script>
    function showTerm(id) { document.getElementById(id).classList.add('active'); }
    function closeTerm(id) { document.getElementById(id).classList.remove('active'); }
    function switchTab(termId, tabIndex) {
        const popup = document.getElementById(termId);
        const tabs = popup.querySelectorAll('.itab-tab');
        const contents = popup.querySelectorAll('.itab-tab-content');
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.classList.remove('active'));
        tabs[tabIndex].classList.add('active');
        contents[tabIndex].classList.add('active');
    }
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('itab-popup')) {
            e.target.classList.remove('active');
        }
    });
<\/script>
```

</body>
</html>`;
        }

```
    function showTerm(id) {
        document.getElementById(id).classList.add('active');
    }

    function closeTerm(id) {
        document.getElementById(id).classList.remove('active');
    }

    function switchTab(termId, tabIndex) {
        const popup = document.getElementById(termId);
        const tabs = popup.querySelectorAll('.itab-tab');
        const contents = popup.querySelectorAll('.itab-tab-content');
        
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.classList.remove('active'));
        
        tabs[tabIndex].classList.add('active');
        contents[tabIndex].classList.add('active');
    }

    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('itab-popup')) {
            e.target.classList.remove('active');
        }
    });

    function clearForm() {
        location.reload();
    }

    function showError(message) {
        const errorDiv = document.getElementById('errorMessage');
        const errorText = document.getElementById('errorText');
        errorText.textContent = message;
        errorDiv.classList.add('active');
        setTimeout(() => {
            errorDiv.classList.remove('active');
        }, 6000);
    }

    function copyCode() {
        const code = document.getElementById('codeBox').textContent;
        navigator.clipboard.writeText(code).then(() => {
            const msg = document.getElementById('successMessage');
            msg.classList.add('active');
            setTimeout(() => {
                msg.classList.remove('active');
            }, 3000);
        }).catch(err => {
            alert('Could not copy to clipboard. Please select and copy manually.');
        });
    }
</script>
```

</body>
</html>
