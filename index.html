<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iTabs Generator - Tooltips 2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
        background: #f8f9fa;
        line-height: 1.6;
    }

    /* Hero Section */
    .hero {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        text-align: center;
        padding: 60px 20px 40px 20px;
    }
    
    .hero h1 {
        font-size: 2.5em;
        margin-bottom: 15px;
        font-weight: 700;
    }
    
    .hero p {
        font-size: 1.3em;
        opacity: 0.95;
    }

    .free-badge {
        background: #4CAF50;
        color: white;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.5em;
        font-weight: bold;
        margin-left: 10px;
        vertical-align: middle;
    }

    /* iTabs Button Style */
    .itab-inline {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 20px;
        height: 20px;
        background: #3498db;
        color: white;
        border-radius: 50%;
        font-size: 14px;
        font-weight: bold;
        cursor: pointer;
        margin-left: 8px;
        transition: all 0.3s ease;
        vertical-align: middle;
        border: none;
        font-family: serif;
    }

    .itab-inline:hover {
        background: #2980b9;
        transform: scale(1.15);
    }

    /* iTabs Popup */
    .itabs-help-popup {
        display: none;
        position: fixed;
        z-index: 10000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        align-items: center;
        justify-content: center;
        padding: 20px;
    }

    .itabs-help-popup.active {
        display: flex;
    }

    .itabs-help-content {
        position: relative;
        background-color: white;
        border-radius: 20px;
        width: 90%;
        max-width: 600px;
        max-height: 80vh;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        overflow: hidden;
    }

    .itabs-help-header {
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: white;
        padding: 25px 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .itabs-help-header h3 {
        margin: 0;
        font-size: 1.5em;
    }

    .itabs-help-close {
        color: white;
        font-size: 35px;
        font-weight: bold;
        cursor: pointer;
        background: none;
        border: none;
        width: 35px;
        height: 35px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.3s;
    }

    .itabs-help-close:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: rotate(90deg);
    }

    .itabs-help-body {
        padding: 30px;
        max-height: calc(80vh - 100px);
        overflow-y: auto;
    }

    .itabs-help-body p {
        color: #4a5568;
        font-size: 1.05em;
        line-height: 1.8;
        margin-bottom: 15px;
    }

    .itabs-help-body strong {
        color: #2c3e50;
    }

    .itabs-help-body a {
        color: #3498db;
        font-weight: 600;
        text-decoration: none;
    }

    .itabs-help-body a:hover {
        text-decoration: underline;
    }

    .itabs-help-body ul {
        margin-left: 20px;
        margin-bottom: 15px;
    }

    .itabs-help-body li {
        margin-bottom: 8px;
    }

    /* Container */
    .container {
        max-width: 900px;
        margin: -20px auto 40px auto;
        padding: 0 20px;
    }

    /* Instruction Box */
    .instruction-box {
        background: white;
        border-left: 4px solid #4285F4;
        padding: 20px;
        margin-bottom: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .instruction-box h3 {
        color: #4285F4;
        margin-bottom: 15px;
        font-size: 1.3em;
    }

    .instruction-box ol {
        margin-left: 20px;
        color: #333;
    }

    .instruction-box li {
        margin-bottom: 10px;
        line-height: 1.6;
    }

    .instruction-box a {
        color: #4285F4;
        font-weight: bold;
    }

    .instruction-box .demo-note {
        margin-top: 15px;
        padding: 15px;
        background: #e8f4f8;
        border-radius: 8px;
        color: #2980b9;
        font-weight: 600;
    }

    /* Form Section */
    .form-section {
        background: white;
        padding: 30px;
        border-radius: 12px;
        margin-bottom: 25px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .form-section h2 {
        color: #333;
        margin-bottom: 25px;
        font-size: 1.8em;
        border-bottom: 3px solid #667eea;
        padding-bottom: 10px;
    }

    .ai-section {
        background: linear-gradient(135deg, #E8F0FE 0%, #F8E8FF 100%);
        border: 2px solid #667eea;
    }

    .ai-section h2 {
        color: #667eea;
    }

    .form-group {
        margin-bottom: 25px;
    }
    
    label {
        display: block;
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
        font-size: 1.05em;
    }
    
    input[type="text"],
    input[type="url"],
    input[type="file"],
    input[type="password"],
    textarea,
    select {
        width: 100%;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 6px;
        font-size: 15px;
        font-family: Arial, sans-serif;
        transition: border-color 0.3s;
    }

    input[type="text"]:focus,
    input[type="url"]:focus,
    input[type="password"]:focus,
    textarea:focus {
        outline: none;
        border-color: #667eea;
    }
    
    input[type="file"] {
        padding: 10px;
        background: white;
    }
    
    textarea {
        min-height: 100px;
        resize: vertical;
    }

    textarea.prompt-area {
        min-height: 80px;
        background: #f8f9fa;
        font-family: 'Courier New', monospace;
        font-size: 14px;
    }
    
    small {
        color: #666;
        display: block;
        margin-top: 6px;
        font-size: 13px;
        line-height: 1.4;
    }

    .success-indicator {
        color: #28a745;
        font-weight: 600;
    }

    .file-status {
        color: #28a745;
        font-size: 13px;
        margin-top: 8px;
        display: none;
        font-weight: 600;
    }

    .file-status.show {
        display: block;
    }
    
    .or-divider {
        text-align: center;
        margin: 20px 0;
        color: #999;
        font-style: italic;
        font-weight: 600;
        position: relative;
    }

    .or-divider::before,
    .or-divider::after {
        content: "";
        position: absolute;
        top: 50%;
        width: 40%;
        height: 1px;
        background: #ddd;
    }

    .or-divider::before {
        left: 0;
    }

    .or-divider::after {
        right: 0;
    }

    /* Additional Images Section */
    .additional-images {
        margin-top: 20px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
        border: 2px dashed #ddd;
    }

    .additional-images h4 {
        color: #667eea;
        margin-bottom: 15px;
        font-size: 1.1em;
    }

    .image-input-group {
        margin-bottom: 20px;
        padding: 15px;
        background: white;
        border-radius: 8px;
        border: 2px solid #e0e0e0;
        position: relative;
    }

    .image-input-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 8px;
        color: #667eea;
        font-size: 1em;
    }

    .btn-remove-image {
        position: absolute;
        top: 10px;
        right: 10px;
        padding: 6px 12px;
        background: #f44336;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 13px;
        font-weight: bold;
        transition: all 0.3s;
    }

    .btn-remove-image:hover {
        background: #da190b;
    }

    .btn-add-image {
        width: 100%;
        padding: 12px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 15px;
        font-weight: bold;
        transition: all 0.3s;
        margin-top: 10px;
    }

    .btn-add-image:hover {
        background: #5568d3;
    }

    .btn-add-image:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .image-count {
        text-align: center;
        color: #667eea;
        font-weight: 600;
        margin-top: 10px;
    }
    
    /* Buttons */
    .button-group {
        display: flex;
        gap: 15px;
        margin-top: 25px;
    }
    
    button {
        padding: 15px 30px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        transition: all 0.3s;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }

    button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }
    
    .btn-ai-generate {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        flex: 1;
        font-size: 18px;
    }

    .btn-ai-generate:hover:not(:disabled) {
        background: linear-gradient(135deg, #5568d3 0%, #6a3f8f 100%);
    }
    
    .btn-generate {
        background: #4CAF50;
        color: white;
        flex: 1;
    }
    
    .btn-generate:hover:not(:disabled) {
        background: #45a049;
    }
    
    .btn-clear {
        background: #f44336;
        color: white;
    }
    
    .btn-clear:hover {
        background: #da190b;
    }
    
    .btn-copy {
        background: #2196F3;
        color: white;
        width: 100%;
    }
    
    .btn-copy:hover {
        background: #0b7dda;
    }

    /* Loading State */
    .loading {
        display: none;
        text-align: center;
        padding: 25px;
        color: #666;
    }

    .loading.active {
        display: block;
    }

    .loading-spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 0 auto 15px;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Messages */
    .error-message {
        background: #f8d7da;
        border: 2px solid #f5c6cb;
        color: #721c24;
        padding: 15px;
        border-radius: 6px;
        margin-top: 15px;
        display: none;
    }

    .error-message.active {
        display: block;
    }

    .success-message {
        display: none;
        background: #4CAF50;
        color: white;
        padding: 12px;
        border-radius: 6px;
        margin-top: 15px;
        text-align: center;
        font-weight: 600;
    }
    
    .success-message.active {
        display: block;
    }

    /* Preview Section */
    .preview-section {
        display: none;
        background: white;
        padding: 30px;
        border-radius: 12px;
        margin-bottom: 25px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .preview-section.active {
        display: block;
    }

    .preview-section h2 {
        color: #333;
        margin-bottom: 10px;
        font-size: 1.8em;
    }

    .preview-subtitle {
        color: #666;
        margin-bottom: 25px;
        font-size: 1.1em;
    }

    /* Example Card Style */
    .example-card {
        background: white;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        max-width: 500px;
        margin: 0 auto 30px auto;
    }

    .example-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 50px rgba(0,0,0,0.15);
    }

    /* Carousel Styles */
    .image-container {
        position: relative;
        width: 100%;
        height: 350px;
        overflow: hidden;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        cursor: pointer;
    }

    .carousel-wrapper {
        position: relative;
        width: 100%;
        height: 100%;
        overflow: hidden;
    }

    .carousel-track {
        display: flex;
        transition: transform 0.4s ease;
        height: 100%;
    }

    .carousel-slide {
        min-width: 100%;
        height: 100%;
        position: relative;
    }

    .preview-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .preview-overlay {
        position: absolute;
        color: white;
        font-weight: bold;
        font-size: 18px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        padding: 10px;
        z-index: 10;
        display: none;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        width: 90%;
    }
    
    .preview-overlay.show {
        display: block;
    }
    
    .preview-overlay.top {
        top: 10px;
    }
    
    .preview-overlay.center {
        top: 50%;
        transform: translate(-50%, -50%);
    }
    
    .preview-overlay.bottom {
        bottom: 10px;
    }

    /* Carousel Indicators */
    .carousel-indicators {
        position: absolute;
        bottom: 15px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 8px;
        z-index: 15;
    }

    .carousel-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.5);
        cursor: pointer;
        transition: all 0.3s;
        border: 2px solid white;
    }

    .carousel-dot.active {
        background: white;
        width: 12px;
        height: 12px;
    }

    /* Image Counter */
    .image-counter {
        position: absolute;
        bottom: 15px;
        right: 15px;
        background: rgba(0, 0, 0, 0.6);
        color: white;
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 14px;
        font-weight: bold;
        z-index: 15;
    }

    .itabs-button {
        position: absolute;
        top: 20px;
        right: 20px;
        width: 45px;
        height: 45px;
        background: rgba(255, 255, 255, 0.95);
        color: #667eea;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 24px;
        cursor: pointer;
        box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        transition: all 0.3s ease;
        border: 3px solid white;
        z-index: 20;
    }
    
    .itabs-button:hover {
        transform: scale(1.15);
        box-shadow: 0 6px 30px rgba(102, 126, 234, 0.5);
        background: white;
    }

    .card-content {
        padding: 25px;
        text-align: center;
    }

    .card-title {
        font-size: 1.3em;
        color: #2d3748;
        margin-bottom: 10px;
        font-weight: 600;
    }

    .card-description {
        color: #718096;
        font-size: 1em;
        line-height: 1.6;
    }

    /* Modal Popup */
    .itabs-popup {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        animation: fadeIn 0.3s ease;
    }

    .itabs-popup.active {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    .popup-content {
        position: relative;
        background-color: white;
        padding: 0;
        border-radius: 20px;
        width: 90%;
        max-width: 600px;
        max-height: 80vh;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        animation: slideIn 0.3s ease;
        overflow: hidden;
    }
    
    @keyframes slideIn {
        from {
            transform: translateY(-50px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }
    
    .modal-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .modal-header h3 {
        margin: 0;
        font-size: 1.8em;
    }
    
    .close {
        color: white;
        font-size: 40px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        line-height: 1;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: none;
        border: none;
        padding: 0;
    }
    
    .close:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: rotate(90deg);
    }
    
    .modal-body {
        padding: 35px;
        max-height: calc(80vh - 120px);
        overflow-y: auto;
    }
    
    .modal-body h4 {
        color: #667eea;
        font-size: 1.4em;
        margin-bottom: 15px;
        margin-top: 25px;
    }
    
    .modal-body h4:first-child {
        margin-top: 0;
    }
    
    .modal-body p {
        color: #4a5568;
        font-size: 1.05em;
        line-height: 1.8;
        margin-bottom: 15px;
    }

    .popup-button {
        display: block;
        margin: 25px 35px;
        padding: 15px;
        background: #4CAF50;
        color: white;
        text-align: center;
        text-decoration: none;
        border-radius: 8px;
        font-weight: bold;
        font-size: 1.1em;
        transition: all 0.3s;
    }
    
    .popup-button:hover {
        background: #45a049;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
    }

    /* Code Section */
    .code-section {
        margin-top: 30px;
    }

    .code-section h3 {
        color: #333;
        margin-bottom: 10px;
        font-size: 1.5em;
    }

    .code-instruction {
        color: #666;
        margin-bottom: 15px;
        font-size: 1.05em;
    }
    
    .code-box {
        background: #2d3748;
        color: #e2e8f0;
        border-radius: 8px;
        padding: 20px;
        font-family: 'Courier New', monospace;
        font-size: 13px;
        max-height: 400px;
        overflow-y: auto;
        margin-bottom: 15px;
        word-wrap: break-word;
        white-space: pre-wrap;
        line-height: 1.5;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
        .hero h1 {
            font-size: 2em;
        }
        
        .hero p {
            font-size: 1.1em;
        }

        .form-section {
            padding: 20px;
        }

        .button-group {
            flex-direction: column;
        }

        button {
            width: 100%;
        }

        .image-container {
            height: 280px;
        }

        .itabs-button {
            width: 40px;
            height: 40px;
            font-size: 20px;
        }
    }
</style>
```

</head>
<body>
    <!-- Hero Section -->
    <div class="hero">
        <h1>iTabs Generator<span class="free-badge">100% FREE</span></h1>
        <p>Tooltips 2.0 - Create beautiful information popups with AI</p>
    </div>

```
<!-- Main Container -->
<div class="container">
    <!-- Instructions -->
    <div class="instruction-box">
        <h3>üöÄ How It Works:</h3>
        <ol>
            <li>Get your <strong>FREE</strong> Google API key from <a href="https://aistudio.google.com/app/apikey" target="_blank">aistudio.google.com/app/apikey</a> (no credit card needed!)</li>
            <li>Paste your campaign/product URL below</li>
            <li>Upload your image(s) or use URLs - add up to 5 images!</li>
            <li>Click "Generate with AI" and wait 30 seconds</li>
            <li>Review AI-generated content and click "Generate iTabs Code"</li>
            <li>Copy the code and paste it on your website!</li>
        </ol>
        <div class="demo-note">
            üí° See the blue "i" buttons below? That's iTabs in action - click them to see how they work!
        </div>
    </div>

    <!-- AI Generation Section -->
    <div class="form-section ai-section">
        <h2>‚ú® AI-Powered iTabs Generator</h2>
        
        <div class="form-group">
            <label for="campaignUrl">üìé Campaign/Product URL:</label>
            <input type="url" id="campaignUrl" value="https://www.birchal.com/company/bioanalytics" placeholder="https://www.birchal.com/company/your-campaign">
            <small><span class="success-indicator">‚úÖ Pre-filled with sample campaign</span> (change to your own URL if needed)</small>
        </div>

        <div class="form-group">
            <label for="aiPrompt">
                ü§ñ AI Instructions
                <button class="itab-inline" onclick="showHelp('ai-prompt')">i</button>
            </label>
            <textarea id="aiPrompt" class="prompt-area" placeholder="Tell AI how to write your content...">Read this page and extract the key information. Write 4 short sections (2-3 sentences each) in simple, clear language that anyone can understand. Focus on what it is, why it matters, how it works, and what makes it special.</textarea>
            <small>‚úèÔ∏è Edit this to customize how AI writes your content</small>
        </div>

        <div class="form-group">
            <label for="imageUpload">üñºÔ∏è Product/Campaign Images (Image #1):</label>
            <input type="file" id="imageUpload" accept="image/*">
            <div id="uploadStatus" class="file-status">‚úì Image uploaded successfully</div>
            
            <div class="or-divider">OR</div>
            
            <input type="url" id="imageUrl" value="https://i.ibb.co/391375nn/IMG-3599.jpg" placeholder="https://your-image-url.com/image.jpg">
            <small><span class="success-indicator">‚úÖ Pre-filled with sample image</span> (upload your own or paste a URL)</small>

            <!-- Additional Images Section -->
            <div class="additional-images">
                <h4>‚ûï Additional Images (Optional - Show Multiple Views)</h4>
                <small style="color: #667eea; margin-bottom: 15px; display: block;">Add up to 4 more images to create a swipeable carousel! Perfect for showing different angles, features, or team photos.</small>
                <div id="additionalImagesContainer"></div>
                <button type="button" class="btn-add-image" id="addImageBtn">+ Add Another Image</button>
                <div class="image-count" id="imageCount"></div>
            </div>
        </div>

        <div class="form-group">
            <label for="apiKey">
                üîë Google API Key (FREE)
                <button class="itab-inline" onclick="showHelp('api-key')">i</button>
            </label>
            <input type="password" id="apiKey" placeholder="Paste your FREE Google API key here">
            <small>Get it instantly at <a href="https://aistudio.google.com/app/apikey" target="_blank">aistudio.google.com/app/apikey</a> - No payment required!</small>
        </div>

        <div class="form-group">
            <label for="imgbbKey">
                üñºÔ∏è ImgBB API Key (FREE - Optional)
                <button class="itab-inline" onclick="showHelp('imgbb-key')">i</button>
            </label>
            <input type="password" id="imgbbKey" value="59cd5b2935b5b01bc744b5b0a1d26ee0" placeholder="Paste your FREE ImgBB API key here (optional)">
            <small>Get it from <a href="https://api.imgbb.com/" target="_blank">api.imgbb.com</a></small>
        </div>

        <div class="button-group">
            <button class="btn-ai-generate" id="aiGenerateBtn">‚ú® Generate with AI</button>
        </div>

        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p id="loadingText">Reading campaign page...</p>
        </div>

        <div class="error-message" id="errorMessage"></div>
    </div>

    <!-- Manual Edit Section -->
    <div class="form-section">
        <h2>‚úçÔ∏è Review & Edit Content</h2>
        <p style="color: #666; margin-bottom: 25px;">AI will fill these fields automatically, or you can write your own content</p>
        
        <div class="form-group">
            <label for="overlayText">üí¨ Text Overlay (Optional):</label>
            <input type="text" id="overlayText" placeholder="e.g., Click the i for more info" value="Click the i for more info">
            <small>Short text that appears on the image (leave blank for no overlay)</small>
        </div>

        <div class="form-group">
            <label for="overlayColor">üé® Overlay Text Color:</label>
            <select id="overlayColor">
                <option value="white" selected>White</option>
                <option value="black">Black</option>
            </select>
        </div>

        <div class="form-group">
            <label for="overlayPosition">üìç Overlay Position:</label>
            <select id="overlayPosition">
                <option value="top">Top</option>
                <option value="center" selected>Center</option>
                <option value="bottom">Bottom</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="section1">‚ùì What is it?</label>
            <textarea id="section1" placeholder="AI will fill this, or write it yourself..."></textarea>
        </div>
        
        <div class="form-group">
            <label for="section2">üí° Why do I need it?</label>
            <textarea id="section2" placeholder="AI will fill this, or write it yourself..."></textarea>
        </div>
        
        <div class="form-group">
            <label for="section3">‚öôÔ∏è How does it work?</label>
            <textarea id="section3" placeholder="AI will fill this, or write it yourself..."></textarea>
        </div>
        
        <div class="form-group">
            <label for="section4">‚≠ê What makes it different?</label>
            <textarea id="section4" placeholder="AI will fill this, or write it yourself..."></textarea>
        </div>
        
        <div class="form-group">
            <label for="buttonText">üîò Button Text:</label>
            <input type="text" id="buttonText" value="Learn More" placeholder="e.g., Learn More, Get Started, Donate Now">
        </div>
        
        <div class="form-group">
            <label for="buttonLink">üîó Button Links To:</label>
            <input type="url" id="buttonLink" placeholder="https://your-website.com">
        </div>
        
        <div class="button-group">
            <button class="btn-generate" id="generateBtn">üé® Generate iTabs Code</button>
            <button class="btn-clear" id="clearBtn">üîÑ Clear Form</button>
        </div>
    </div>

    <!-- Preview Section -->
    <div class="preview-section" id="previewSection">
        <h2>‚ú® Preview Your iTabs</h2>
        <p class="preview-subtitle">Click the "i" button to test your popup! <span id="previewImageInfo">Swipe to navigate between images.</span></p>
        
        <div class="example-card">
            <div class="image-container" id="imageContainer">
                <div class="carousel-wrapper">
                    <div class="carousel-track" id="carouselTrack"></div>
                </div>
                
                <div class="carousel-indicators" id="carouselIndicators"></div>
                <div class="image-counter" id="imageCounterDisplay">1/1</div>
                <div class="itabs-button" id="previewItabsBtn">i</div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Your iTabs Preview</h3>
                <p class="card-description">This is how your interactive popup will look on your website</p>
            </div>
        </div>
        
        <div class="code-section">
            <h3>üìã Your iTabs Code</h3>
            <p class="code-instruction">Copy this code and paste it anywhere on your website:</p>
            <div class="code-box" id="codeBox"></div>
            <button class="btn-copy" id="copyBtn">üìã Copy Code to Clipboard</button>
            <div class="success-message" id="successMessage">‚úÖ Code copied to clipboard!</div>
        </div>
    </div>
</div>

<!-- Help Popups -->
<div class="itabs-help-popup" id="helpPopupApiKey">
    <div class="itabs-help-content">
        <div class="itabs-help-header">
            <h3>üîë What's a Google API Key?</h3>
            <button class="itabs-help-close" onclick="closeHelp('api-key')">&times;</button>
        </div>
        <div class="itabs-help-body">
            <p><strong>What it is:</strong> A free password that lets this generator use Google's AI to read webpages and write your iTabs content automatically.</p>
            
            <p><strong>Why you need it:</strong> Without it, you'd have to write all 4 sections yourself. With it, AI does it in 30 seconds.</p>
            
            <p><strong>How to get yours (takes 2 minutes):</strong></p>
            <ul>
                <li>Go to <a href="https://aistudio.google.com/app/apikey" target="_blank">aistudio.google.com/app/apikey</a></li>
                <li>Click "Create API Key"</li>
                <li>Copy the key (looks like: AIzaSyB...)</li>
                <li>Paste it in the field above</li>
            </ul>
            
            <p><strong>Is it really free?</strong> Yes! Google gives you plenty of free AI requests per month. No credit card needed.</p>
            
            <p><strong>Is it safe?</strong> Yes - your API key only works for Google AI, nothing else. This generator doesn't store it.</p>
        </div>
    </div>
</div>

<div class="itabs-help-popup" id="helpPopupImgbbKey">
    <div class="itabs-help-content">
        <div class="itabs-help-header">
            <h3>üñºÔ∏è What's ImgBB?</h3>
            <button class="itabs-help-close" onclick="closeHelp('imgbb-key')">&times;</button>
        </div>
        <div class="itabs-help-body">
            <p><strong>What it is:</strong> A free image hosting service that stores your images online so your iTabs code works anywhere.</p>
            
            <p><strong>Why it matters:</strong></p>
            <ul>
                <li><strong>Without ImgBB:</strong> Your images only work in preview - code won't work on your website</li>
                <li><strong>With ImgBB:</strong> Images are hosted online - your iTabs code works everywhere</li>
            </ul>
            
            <p><strong>How to get your free key:</strong></p>
            <ul>
                <li>Go to <a href="https://api.imgbb.com/" target="_blank">api.imgbb.com</a></li>
                <li>Create free account (takes 1 minute)</li>
                <li>Copy your API key</li>
                <li>Paste it in the field above</li>
            </ul>
            
            <p><strong>Is it optional?</strong> Yes, but highly recommended! Without it, you'll need to host images yourself.</p>
            
            <p><strong>Alternative:</strong> If you already have image URLs (from your website, Dropbox, etc.), just paste those instead.</p>
        </div>
    </div>
</div>

<div class="itabs-help-popup" id="helpPopupAiPrompt">
    <div class="itabs-help-content">
        <div class="itabs-help-header">
            <h3>ü§ñ AI Instructions Explained</h3>
            <button class="itabs-help-close" onclick="closeHelp('ai-prompt')">&times;</button>
        </div>
        <div class="itabs-help-body">
            <p><strong>What this does:</strong> Tells AI how to write your content. Think of it like giving writing instructions to a helpful assistant.</p>
            
            <p><strong>The default instruction works great:</strong> "Read this page and extract key information. Write 4 short sections in simple language..."</p>
            
            <p><strong>But you can customize it:</strong></p>
            <ul>
                <li><strong>Writing style:</strong> "Write in a professional tone" or "Write casually, like talking to a friend"</li>
                <li><strong>Target audience:</strong> "Explain it to teenagers" or "Write for business executives"</li>
                <li><strong>Length:</strong> "Keep each section to 1 sentence" or "Write detailed 4-sentence sections"</li>
                <li><strong>Focus:</strong> "Focus on the environmental benefits" or "Emphasize cost savings"</li>
            </ul>
            
            <p><strong>Example custom prompts:</strong></p>
            <p><em>"Read this crowdfunding page. Write 4 emotional, inspiring sections that make people want to donate. Use storytelling and personal language."</em></p>
            
            <p><em>"Analyze this technical product. Write 4 sections explaining it to non-technical people. Use simple analogies and avoid jargon."</em></p>
            
            <p><strong>Pro tip:</strong> The more specific your instructions, the better AI's output!</p>
        </div>
    </div>
</div>

<!-- Main Content Popup -->
<div class="itabs-popup" id="itabsPopup">
    <div class="popup-content">
        <div class="modal-header">
            <h3 id="popupTitle">Your Product</h3>
            <button class="close" id="closeBtn">&times;</button>
        </div>
        <div class="modal-body">
            <h4>What is it?</h4>
            <p id="popupSection1"></p>
            
            <h4>Why do I need it?</h4>
            <p id="popupSection2"></p>
            
            <h4>How does it work?</h4>
            <p id="popupSection3"></p>
            
            <h4>What makes it different?</h4>
            <p id="popupSection4"></p>
            
            <a href="#" id="popupButton" class="popup-button" target="_blank">Learn More</a>
        </div>
    </div>
</div>

<script>
    // Global variables
    let uploadedImageData = null;
    let additionalImageCount = 0;
    const MAX_IMAGES = 5;
    let previewCarouselIndex = 0;
    let previewImages = [];
    let touchStartX = 0;
    let touchEndX = 0;
    let additionalUploadedImages = {};

    // Help popup functions
    function showHelp(helpType) {
        const popupId = 'helpPopup' + helpType.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join('');
        const popup = document.getElementById(popupId);
        if (popup) {
            popup.classList.add('active');
        }
    }

    function closeHelp(helpType) {
        const popupId = 'helpPopup' + helpType.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join('');
        const popup = document.getElementById(popupId);
        if (popup) {
            popup.classList.remove('active');
        }
    }

    // Close help popup when clicking outside
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('itabs-help-popup')) {
            e.target.classList.remove('active');
        }
    });

    // Wait for DOM to load
    document.addEventListener('DOMContentLoaded', function() {
        console.log('iTabs Generator loaded');
        
        // Get all elements
        const generateBtn = document.getElementById('generateBtn');
        const aiGenerateBtn = document.getElementById('aiGenerateBtn');
        const clearBtn = document.getElementById('clearBtn');
        const copyBtn = document.getElementById('copyBtn');
        const previewItabsBtn = document.getElementById('previewItabsBtn');
        const closeBtn = document.getElementById('closeBtn');
        const itabsPopup = document.getElementById('itabsPopup');
        const imageUpload = document.getElementById('imageUpload');
        const imageUrl = document.getElementById('imageUrl');
        const uploadStatus = document.getElementById('uploadStatus');
        const addImageBtn = document.getElementById('addImageBtn');
        
        // Attach event listeners
        generateBtn.addEventListener('click', generatePreview);
        aiGenerateBtn.addEventListener('click', aiGenerate);
        clearBtn.addEventListener('click', clearForm);
        copyBtn.addEventListener('click', copyCode);
        previewItabsBtn.addEventListener('click', openPopup);
        closeBtn.addEventListener('click', closePopup);
        
        // Add image button
        addImageBtn.addEventListener('click', function() {
            console.log('Add Image button clicked, count:', additionalImageCount);
            addImage();
        });
        
        // Touch swipe support
        const carouselWrapper = document.querySelector('.carousel-wrapper');
        carouselWrapper.addEventListener('touchstart', handleTouchStart, false);
        carouselWrapper.addEventListener('touchend', handleTouchEnd, false);
        
        // Primary image upload
        imageUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    uploadedImageData = event.target.result;
                    uploadStatus.textContent = '‚è≥ Uploading image to ImgBB...';
                    uploadStatus.classList.add('show');
                    
                    const imgbbKey = document.getElementById('imgbbKey').value.trim();
                    if (imgbbKey) {
                        uploadToImgBB(file, imgbbKey);
                    } else {
                        uploadStatus.textContent = '‚úì Image loaded (will work in preview only - add ImgBB API key to host online)';
                        uploadStatus.style.color = '#ffc107';
                    }
                    
                    document.getElementById('imageUrl').value = '';
                };
                reader.readAsDataURL(file);
            } else {
                alert('Please select a valid image file');
                imageUpload.value = '';
            }
        });

        // Clear URL when file is uploaded
        imageUrl.addEventListener('input', function() {
            if (imageUrl.value.trim() !== '') {
                imageUpload.value = '';
                uploadedImageData = null;
                uploadStatus.classList.remove('show');
            }
        });
        
        // Click outside popup to close
        itabsPopup.addEventListener('click', function(e) {
            if (e.target === itabsPopup) {
                closePopup();
            }
        });

        updateImageCount();
    });

    // Touch handlers
    function handleTouchStart(e) {
        touchStartX = e.changedTouches[0].screenX;
    }

    function handleTouchEnd(e) {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
    }

    function handleSwipe() {
        if (touchEndX < touchStartX - 50) {
            moveCarousel(1);
        }
        if (touchEndX > touchStartX + 50) {
            moveCarousel(-1);
        }
    }

    // Add image function
    function addImage() {
        if (additionalImageCount >= MAX_IMAGES - 1) {
            alert('Maximum ' + MAX_IMAGES + ' images allowed');
            return;
        }

        additionalImageCount++;
        const imageNum = additionalImageCount + 1;
        console.log('Adding image #' + imageNum);
        
        const container = document.getElementById('additionalImagesContainer');
        
        const div = document.createElement('div');
        div.className = 'image-input-group';
        div.setAttribute('data-image-number', imageNum);
        div.innerHTML = `
            <button type="button" class="btn-remove-image">‚úï Remove</button>
            <label>üñºÔ∏è Image #${imageNum}:</label>
            <input type="file" 
                   class="additional-image-upload" 
                   accept="image/*"
                   data-image-number="${imageNum}">
            <div class="file-status" id="uploadStatus${imageNum}"></div>
            
            <div class="or-divider">OR</div>
            
            <input type="url" 
                   class="additional-image-url" 
                   placeholder="https://your-image-url.com/image${imageNum}.jpg"
                   data-image-number="${imageNum}">
        `;
        
        container.appendChild(div);
        
        // Attach event listeners to new elements
        const removeBtn = div.querySelector('.btn-remove-image');
        removeBtn.addEventListener('click', function() {
            removeImage(this, imageNum);
        });
        
        const fileInput = div.querySelector('.additional-image-upload');
        fileInput.addEventListener('change', function() {
            handleAdditionalImageUpload(this);
        });
        
        const urlInput = div.querySelector('.additional-image-url');
        urlInput.addEventListener('input', function() {
            if (this.value.trim() !== '') {
                fileInput.value = '';
                const statusDiv = div.querySelector('.file-status');
                statusDiv.classList.remove('show');
                delete additionalUploadedImages[imageNum];
            }
        });
        
        updateImageCount();
        updateAddButtonState();
    }

    function removeImage(button, num) {
        console.log('Removing image #' + num);
        const inputGroup = button.parentElement;
        delete additionalUploadedImages[num];
        inputGroup.remove();
        additionalImageCount--;
        updateImageCount();
        updateAddButtonState();
        renumberImages();
    }

    function handleAdditionalImageUpload(input) {
        const file = input.files[0];
        const imageNum = input.getAttribute('data-image-number');
        const statusDiv = document.getElementById('uploadStatus' + imageNum);
        const inputGroup = input.closest('.image-input-group');
        const urlInput = inputGroup.querySelector('.additional-image-url');
        
        if (file && file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = function(event) {
                additionalUploadedImages[imageNum] = event.target.result;
                statusDiv.textContent = '‚è≥ Uploading image to ImgBB...';
                statusDiv.classList.add('show');
                
                const imgbbKey = document.getElementById('imgbbKey').value.trim();
                if (imgbbKey) {
                    uploadAdditionalToImgBB(file, imgbbKey, imageNum, statusDiv, urlInput);
                } else {
                    statusDiv.textContent = '‚úì Image loaded (add ImgBB API key to host online)';
                    statusDiv.style.color = '#ffc107';
                }
                
                urlInput.value = '';
            };
            reader.readAsDataURL(file);
        } else {
            alert('Please select a valid image file');
            input.value = '';
        }
    }

    async function uploadAdditionalToImgBB(file, apiKey, imageNum, statusDiv, urlInput) {
        try {
            const formData = new FormData();
            formData.append('image', file);
            
            const response = await fetch('https://api.imgbb.com/1/upload?key=' + apiKey, {
                method: 'POST',
                body: formData
            });
            
            if (!response.ok) {
                throw new Error('ImgBB upload failed');
            }
            
            const data = await response.json();
            
            if (data.success) {
                const imageUrl = data.data.url;
                urlInput.value = imageUrl;
                delete additionalUploadedImages[imageNum];
                statusDiv.textContent = '‚úì Image uploaded to ImgBB successfully!';
                statusDiv.style.color = '#28a745';
            } else {
                throw new Error('ImgBB API returned error');
            }
        } catch (error) {
            console.error('ImgBB upload error:', error);
            statusDiv.textContent = '‚ö†Ô∏è Image loaded locally (add valid ImgBB API key to host online)';
            statusDiv.style.color = '#ffc107';
        }
    }

    function renumberImages() {
        const groups = document.querySelectorAll('.image-input-group');
        groups.forEach((group, index) => {
            const imageNum = index + 2;
            group.setAttribute('data-image-number', imageNum);
            
            const label = group.querySelector('label');
            if (label) label.textContent = 'üñºÔ∏è Image #' + imageNum + ':';
            
            const fileInput = group.querySelector('.additional-image-upload');
            if (fileInput) fileInput.setAttribute('data-image-number', imageNum);
            
            const urlInput = group.querySelector('.additional-image-url');
            if (urlInput) {
                urlInput.setAttribute('data-image-number', imageNum);
                urlInput.placeholder = 'https://your-image-url.com/image' + imageNum + '.jpg';
            }
            
            const statusDiv = group.querySelector('.file-status');
            if (statusDiv) statusDiv.id = 'uploadStatus' + imageNum;
        });
    }

    function updateImageCount() {
        const countDiv = document.getElementById('imageCount');
        const totalImages = additionalImageCount + 1;
        if (additionalImageCount > 0) {
            countDiv.textContent = 'üì∏ Total: ' + totalImages + ' image' + (totalImages > 1 ? 's' : '');
        } else {
            countDiv.textContent = '';
        }
    }

    function updateAddButtonState() {
        const addBtn = document.getElementById('addImageBtn');
        if (additionalImageCount >= MAX_IMAGES - 1) {
            addBtn.disabled = true;
            addBtn.textContent = '‚úì Maximum ' + MAX_IMAGES + ' Images Added';
        } else {
            addBtn.disabled = false;
            addBtn.textContent = '+ Add Another Image';
        }
    }

    function getAllImageUrls() {
        const images = [];
        
        // Get primary image
        const imageUrlInput = document.getElementById('imageUrl');
        if (imageUrlInput.value.trim() !== '') {
            images.push(imageUrlInput.value.trim());
        } else if (uploadedImageData) {
            images.push(uploadedImageData);
        }
        
        // Get additional images
        const additionalGroups = document.querySelectorAll('.image-input-group');
        additionalGroups.forEach(group => {
            const imageNum = group.getAttribute('data-image-number');
            const urlInput = group.querySelector('.additional-image-url');
            
            if (urlInput.value.trim() !== '') {
                images.push(urlInput.value.trim());
            } else if (additionalUploadedImages[imageNum]) {
                images.push(additionalUploadedImages[imageNum]);
            }
        });
        
        return images;
    }

    function buildCarousel(images, overlayText, overlayPosition, overlayColor) {
        const track = document.getElementById('carouselTrack');
        const indicators = document.getElementById('carouselIndicators');
        
        track.innerHTML = '';
        indicators.innerHTML = '';
        
        images.forEach((imgSrc, index) => {
            const slide = document.createElement('div');
            slide.className = 'carousel-slide';
            
            const img = document.createElement('img');
            img.className = 'preview-image';
            img.src = imgSrc;
            img.alt = 'Product ' + (index + 1);
            
            slide.appendChild(img);
            
            if (index === 0 && overlayText.trim() !== '') {
                const overlay = document.createElement('div');
                overlay.className = 'preview-overlay show ' + overlayPosition;
                overlay.style.color = overlayColor;
                overlay.textContent = overlayText;
                slide.appendChild(overlay);
            }
            
            track.appendChild(slide);
            
            const dot = document.createElement('div');
            dot.className = 'carousel-dot' + (index === 0 ? ' active' : '');
            dot.addEventListener('click', () => goToSlide(index));
            indicators.appendChild(dot);
        });
        
        previewImages = images;
        previewCarouselIndex = 0;
        updateCarouselDisplay();
    }

    function moveCarousel(direction) {
        if (previewImages.length <= 1) return;
        
        previewCarouselIndex += direction;
        
        if (previewCarouselIndex < 0) {
            previewCarouselIndex = previewImages.length - 1;
        } else if (previewCarouselIndex >= previewImages.length) {
            previewCarouselIndex = 0;
        }
        
        updateCarouselDisplay();
    }

    function goToSlide(index) {
        previewCarouselIndex = index;
        updateCarouselDisplay();
    }

    function updateCarouselDisplay() {
        const track = document.getElementById('carouselTrack');
        const dots = document.querySelectorAll('.carousel-dot');
        const counter = document.getElementById('imageCounterDisplay');
        
        track.style.transform = 'translateX(-' + (previewCarouselIndex * 100) + '%)';
        
        dots.forEach((dot, index) => {
            dot.classList.toggle('active', index === previewCarouselIndex);
        });
        
        counter.textContent = (previewCarouselIndex + 1) + '/' + previewImages.length;
        
        // Show/hide indicators based on image count
        if (previewImages.length <= 1) {
            document.getElementById('carouselIndicators').style.display = 'none';
            counter.style.display = 'none';
        } else {
            document.getElementById('carouselIndicators').style.display = 'flex';
            counter.style.display = 'block';
        }
    }

    async function uploadToImgBB(file, apiKey) {
        const uploadStatus = document.getElementById('uploadStatus');
        
        try {
            const formData = new FormData();
            formData.append('image', file);
            
            const response = await fetch('https://api.imgbb.com/1/upload?key=' + apiKey, {
                method: 'POST',
                body: formData
            });
            
            if (!response.ok) {
                throw new Error('ImgBB upload failed');
            }
            
            const data = await response.json();
            
            if (data.success) {
                const imageUrl = data.data.url;
                document.getElementById('imageUrl').value = imageUrl;
                uploadedImageData = null;
                uploadStatus.textContent = '‚úì Image uploaded to ImgBB successfully!';
                uploadStatus.style.color = '#28a745';
            } else {
                throw new Error('ImgBB API returned error');
            }
        } catch (error) {
            console.error('ImgBB upload error:', error);
            uploadStatus.textContent = '‚ö†Ô∏è Image loaded locally (add valid ImgBB API key to host online)';
            uploadStatus.style.color = '#ffc107';
        }
    }

    async function aiGenerate() {
        const campaignUrl = document.getElementById('campaignUrl').value.trim();
        const apiKey = document.getElementById('apiKey').value.trim();
        const aiPrompt = document.getElementById('aiPrompt').value.trim();
        const errorMessage = document.getElementById('errorMessage');
        const loading = document.getElementById('loading');
        const loadingText = document.getElementById('loadingText');
        const aiGenerateBtn = document.getElementById('aiGenerateBtn');

        if (!campaignUrl) {
            showError('Please enter a campaign URL');
            return;
        }

        if (!apiKey) {
            showError('Please enter your Google API key. Get it FREE at aistudio.google.com/app/apikey');
            return;
        }

        errorMessage.classList.remove('active');
        loading.classList.add('active');
        aiGenerateBtn.disabled = true;

        try {
            loadingText.textContent = 'üìñ Reading campaign page...';
            const jinaUrl = 'https://r.jina.ai/' + campaignUrl;
            const jinaResponse = await fetch(jinaUrl);
            const pageContent = await jinaResponse.text();

            loadingText.textContent = '‚ú® AI is writing your iTabs content...';
            
            const geminiUrl = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=' + apiKey;
            
            const fullPrompt = aiPrompt + '\n\nCampaign Content:\n' + pageContent.substring(0, 4000) + '\n\nPlease respond in this exact JSON format:\n{\n  "section1": "What is it? (simple explanation)",\n  "section2": "Why do I need it? (the problem it solves)",\n  "section3": "How does it work? (simple steps)",\n  "section4": "What makes it different? (unique value)",\n  "buttonText": "Short call-to-action (3-5 words)",\n  "buttonLink": "' + campaignUrl + '"\n}';
            
            const geminiResponse = await fetch(geminiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: fullPrompt
                        }]
                    }]
                })
            });

            if (!geminiResponse.ok) {
                const errorData = await geminiResponse.json();
                throw new Error('Gemini API error: ' + (errorData.error?.message || geminiResponse.statusText));
            }

            const geminiData = await geminiResponse.json();
            const responseText = geminiData.candidates[0].content.parts[0].text;
            
            const jsonMatch = responseText.match(/\{[\s\S]*\}/);
            if (!jsonMatch) {
                throw new Error('Could not parse AI response');
            }
            
            const aiContent = JSON.parse(jsonMatch[0]);

            document.getElementById('section1').value = aiContent.section1;
            document.getElementById('section2').value = aiContent.section2;
            document.getElementById('section3').value = aiContent.section3;
            document.getElementById('section4').value = aiContent.section4;
            document.getElementById('buttonText').value = aiContent.buttonText;
            document.getElementById('buttonLink').value = aiContent.buttonLink;

            loading.classList.remove('active');
            aiGenerateBtn.disabled = false;
            
            document.getElementById('section1').scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            setTimeout(() => {
                alert('‚ú® AI generated your iTabs content! Review the sections below and click "Generate iTabs Code" when ready.');
            }, 500);

        } catch (error) {
            loading.classList.remove('active');
            aiGenerateBtn.disabled = false;
            showError('Error: ' + error.message);
            console.error(error);
        }
    }

    function showError(message) {
        const errorMessage = document.getElementById('errorMessage');
        errorMessage.textContent = message;
        errorMessage.classList.add('active');
    }
    
    function generatePreview() {
        const images = getAllImageUrls();

        if (images.length === 0) {
            alert('Please upload an image or enter at least one image URL');
            return;
        }

        const overlayText = document.getElementById('overlayText').value;
        const overlayPosition = document.getElementById('overlayPosition').value;
        const overlayColor = document.getElementById('overlayColor').value;
        const section1 = document.getElementById('section1').value;
        const section2 = document.getElementById('section2').value;
        const section3 = document.getElementById('section3').value;
        const section4 = document.getElementById('section4').value;
        const buttonText = document.getElementById('buttonText').value;
        const buttonLink = document.getElementById('buttonLink').value;

        if (!section1 || !section2 || !section3 || !section4) {
            alert('Please fill in all 4 sections or use AI to generate them');
            return;
        }
        
        buildCarousel(images, overlayText, overlayPosition, overlayColor);
        
        // Update preview info for multiple images
        const previewInfo = document.getElementById('previewImageInfo');
        if (images.length > 1) {
            previewInfo.innerHTML = '<span style="color: #667eea; font-weight: bold;">Swipe or tap dots to view all ' + images.length + ' images!</span>';
        } else {
            previewInfo.textContent = '';
        }
        
        document.getElementById('popupSection1').textContent = section1;
        document.getElementById('popupSection2').textContent = section2;
        document.getElementById('popupSection3').textContent = section3;
        document.getElementById('popupSection4').textContent = section4;
        document.getElementById('popupButton').textContent = buttonText;
        document.getElementById('popupButton').href = buttonLink || '#';
        
        const code = generateCode(images, overlayText, overlayPosition, overlayColor, section1, section2, section3, section4, buttonText, buttonLink);
        document.getElementById('codeBox').textContent = code;
        
        document.getElementById('previewSection').classList.add('active');
        document.getElementById('previewSection').scrollIntoView({ behavior: 'smooth' });
    }
    
    function generateCode(imageUrls, overlayText, overlayPosition, overlayColor, s1, s2, s3, s4, btnText, btnLink) {
        const positionStyles = {
            'top': 'top: 10px;',
            'center': 'top: 50%; transform: translate(-50%, -50%);',
            'bottom': 'bottom: 10px;'
        };
        
        let slidesHTML = '';
        imageUrls.forEach((url, index) => {
            const overlayHTML = (index === 0 && overlayText.trim() !== '') 
                ? '        <div style="position: absolute; ' + positionStyles[overlayPosition] + ' left: 50%; transform: translateX(-50%); color: ' + overlayColor + '; font-weight: bold; font-size: 18px; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); padding: 10px; z-index: 10; text-align: center; width: 90%;">' + overlayText + '</div>\n'
                : '';
            
            slidesHTML += '        <div style="min-width: 100%; height: 100%;">\n            <img src="' + url + '" alt="Product ' + (index + 1) + '" style="width: 100%; height: 100%; object-fit: cover;">\n' + overlayHTML + '        </div>\n';
        });

        let dotsHTML = '';
        imageUrls.forEach((_, index) => {
            dotsHTML += '        <div class="itabs-dot" data-slide="' + index + '" style="width: 10px; height: 10px; border-radius: 50%; background: ' + (index === 0 ? 'white' : 'rgba(255,255,255,0.5)') + '; cursor: pointer; transition: all 0.3s; border: 2px solid white;"></div>\n';
        });

        const carouselControls = imageUrls.length > 1 ? '    <div style="position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%); display: flex; gap: 8px; z-index: 15;">\n' + dotsHTML + '    </div>\n    <div id="itabsCounter" style="position: absolute; bottom: 15px; right: 15px; background: rgba(0,0,0,0.6); color: white; padding: 5px 12px; border-radius: 15px; font-size: 14px; font-weight: bold; z-index: 15;">1/' + imageUrls.length + '</div>' : '';

        return '<!-- iTabs Code - Beautiful Interactive Popup with Image Carousel -->\n<!-- Paste this code where you want your iTabs to appear -->\n\n<div style="background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.1); max-width: 500px; margin: 20px auto;">\n    <div style="position: relative; width: 100%; height: 350px; overflow: hidden; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">\n        <div style="position: relative; width: 100%; height: 100%; overflow: hidden;">\n            <div id="itabsTrack" style="display: flex; transition: transform 0.4s ease; height: 100%;">\n' + slidesHTML + '            </div>\n        </div>\n' + carouselControls + '        <div style="position: absolute; top: 20px; right: 20px; width: 45px; height: 45px; background: rgba(255,255,255,0.95); color: #667eea; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 24px; cursor: pointer; box-shadow: 0 4px 20px rgba(0,0,0,0.2); border: 3px solid white; z-index: 20;" onclick="document.getElementById(\'itabsPopup\').style.display=\'flex\'">i</div>\n    </div>\n    <div style="padding: 25px; text-align: center;">\n        <h3 style="font-size: 1.3em; color: #2d3748; margin-bottom: 10px; font-weight: 600;">Your Product</h3>\n        <p style="color: #718096; font-size: 1em; line-height: 1.6;">' + (imageUrls.length > 1 ? 'Swipe to see more images!' : 'Click the "i" button to learn more') + '</p>\n    </div>\n</div>\n\n<div id="itabsPopup" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); align-items: center; justify-content: center; padding: 20px;">\n    <div style="position: relative; background-color: white; border-radius: 20px; width: 90%; max-width: 600px; max-height: 80vh; box-shadow: 0 20px 60px rgba(0,0,0,0.4); overflow: hidden;">\n        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; display: flex; justify-content: space-between; align-items: center;">\n            <h3 style="margin: 0; font-size: 1.8em;">Your Product</h3>\n            <button onclick="document.getElementById(\'itabsPopup\').style.display=\'none\'" style="color: white; font-size: 40px; font-weight: bold; cursor: pointer; background: none; border: none; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%;">&times;</button>\n        </div>\n        <div style="padding: 35px; max-height: calc(80vh - 120px); overflow-y: auto;">\n            <h4 style="color: #667eea; font-size: 1.4em; margin-bottom: 15px;">What is it?</h4>\n            <p style="color: #4a5568; font-size: 1.05em; line-height: 1.8; margin-bottom: 15px;">' + s1 + '</p>\n            \n            <h4 style="color: #667eea; font-size: 1.4em; margin-bottom: 15px; margin-top: 25px;">Why do I need it?</h4>\n            <p style="color: #4a5568; font-size: 1.05em; line-height: 1.8; margin-bottom: 15px;">' + s2 + '</p>\n            \n            <h4 style="color: #667eea; font-size: 1.4em; margin-bottom: 15px; margin-top: 25px;">How does it work?</h4>\n            <p style="color: #4a5568; font-size: 1.05em; line-height: 1.8; margin-bottom: 15px;">' + s3 + '</p>\n            \n            <h4 style="color: #667eea; font-size: 1.4em; margin-bottom: 15px; margin-top: 25px;">What makes it different?</h4>\n            <p style="color: #4a5568; font-size: 1.05em; line-height: 1.8; margin-bottom: 15px;">' + s4 + '</p>\n            \n            <a href="' + (btnLink || '#') + '" target="_blank" style="display: block; margin: 25px 0; padding: 15px; background: #4CAF50; color: white; text-align: center; text-decoration: none; border-radius: 8px; font-weight: bold; font-size: 1.1em;">' + btnText + '</a>\n        </div>\n    </div>\n</div>\n\n<script>\nvar itabsCurrentSlide = 0;\nvar itabsTotalSlides = ' + imageUrls.length + ';\nvar itabsTouchStartX = 0;\nvar itabsTouchEndX = 0;\n\nfunction itabsGoToSlide(index) {\n    itabsCurrentSlide = index;\n    itabsUpdateCarousel();\n}\n\nfunction itabsUpdateCarousel() {\n    var track = document.getElementById(\'itabsTrack\');\n    var counter = document.getElementById(\'itabsCounter\');\n    var dots = document.querySelectorAll(\'.itabs-dot\');\n    \n    track.style.transform = \'translateX(-\' + (itabsCurrentSlide * 100) + \'%)\';\n    if (counter) counter.textContent = (itabsCurrentSlide + 1) + \'/\' + itabsTotalSlides;\n    \n    dots.forEach(function(dot, index) {\n        dot.style.background = index === itabsCurrentSlide ? \'white\' : \'rgba(255,255,255,0.5)\';\n    });\n}\n\n// Touch swipe navigation\nvar trackElement = document.getElementById(\'itabsTrack\');\nif (trackElement) {\n    trackElement.addEventListener(\'touchstart\', function(e) {\n        itabsTouchStartX = e.changedTouches[0].screenX;\n    });\n    \n    trackElement.addEventListener(\'touchend\', function(e) {\n        itabsTouchEndX = e.changedTouches[0].screenX;\n        if (itabsTouchEndX < itabsTouchStartX - 50) {\n            itabsCurrentSlide++;\n            if (itabsCurrentSlide >= itabsTotalSlides) itabsCurrentSlide = 0;\n            itabsUpdateCarousel();\n        }\n        if (itabsTouchEndX > itabsTouchStartX + 50) {\n            itabsCurrentSlide--;\n            if (itabsCurrentSlide < 0) itabsCurrentSlide = itabsTotalSlides - 1;\n            itabsUpdateCarousel();\n        }\n    });\n}\n\n// Dot click handlers\ndocument.querySelectorAll(\'.itabs-dot\').forEach(function(dot) {\n    dot.addEventListener(\'click\', function() {\n        itabsGoToSlide(parseInt(this.getAttribute(\'data-slide\')));\n    });\n});\n\n// Close popup on outside click\ndocument.getElementById(\'itabsPopup\').addEventListener(\'click\', function(e) {\n    if (e.target.id === \'itabsPopup\') {\n        this.style.display = \'none\';\n    }\n});\n</scr' + 'ipt>';
    }
    
    function clearForm() {
        document.getElementById('campaignUrl').value = 'https://www.birchal.com/company/bioanalytics';
        document.getElementById('apiKey').value = '';
        document.getElementById('aiPrompt').value = 'Read this page and extract the key information. Write 4 short sections (2-3 sentences each) in simple, clear language that anyone can understand. Focus on what it is, why it matters, how it works, and what makes it special.';
        document.getElementById('imageUpload').value = '';
        document.getElementById('imageUrl').value = 'https://i.ibb.co/391375nn/IMG-3599.jpg';
        document.getElementById('overlayText').value = 'Click the i for more info';
        document.getElementById('overlayPosition').value = 'center';
        document.getElementById('overlayColor').value = 'white';
        document.getElementById('section1').value = '';
        document.getElementById('section2').value = '';
        document.getElementById('section3').value = '';
        document.getElementById('section4').value = '';
        document.getElementById('buttonText').value = 'Learn More';
        document.getElementById('buttonLink').value = '';
        document.getElementById('previewSection').classList.remove('active');
        document.getElementById('uploadStatus').classList.remove('show');
        document.getElementById('errorMessage').classList.remove('active');
        document.getElementById('additionalImagesContainer').innerHTML = '';
        additionalImageCount = 0;
        additionalUploadedImages = {};
        updateImageCount();
        updateAddButtonState();
        uploadedImageData = null;
    }
    
    function openPopup() {
        document.getElementById('itabsPopup').classList.add('active');
    }
    
    function closePopup() {
        document.getElementById('itabsPopup').classList.remove('active');
    }
    
    function copyCode() {
        const codeBox = document.getElementById('codeBox');
        const textArea = document.createElement('textarea');
        textArea.value = codeBox.textContent;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        
        const successMessage = document.getElementById('successMessage');
        successMessage.classList.add('active');
        setTimeout(() => {
            successMessage.classList.remove('active');
        }, 3000);
    }
</script>
```

</body>
</html>
